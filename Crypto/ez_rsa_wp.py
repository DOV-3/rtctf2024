import random
from gmpy2 import lcm, powmod, invert, gcd, mpz, gmpy2
from libnum import n2s
from sympy import *

def getpq(n,e,d): #知道n,e,d，求p,q
    while True:
        k = e * d - 1
        g = random.randint(0, n)
        while k%2==0:
            k=k//2
            temp=powmod(g,k,n)-1
            if gcd(temp,n)>1 and temp!=0:
                return gcd(temp,n)

n = 14347257961459348762826574333642954904450160321341720290367756737691205339647046742262025420186291721491196523046061645217835565255079987391880265411247468616738936818336768939257716538950654321113453596355689777113875852727511950968209816705680849662809452449692195981973357825680572749266081067543058120232377014813189939848428110891006747487211012399676376229188710360838171767117158004048826610385024922221144008795130935792818435567054857403686722968380935128742110628745432886844535319427592646544898002680835692734008164220185178061291673000934447397248197134246661425590385799878120904607577913136838020003757
gift = 3586814490364837190706643583410738726112540080335430072591939184422801334911761685565506355046572930372799130761515411304458891313769996847970066352811867154184734204584192234814429134737663580278363399088922444278468963181877987742052454176420212415702363112423048995493339456420143187316520266885764530058034213984068222730104526620915276935610037149262963989180780823254199460203404130922779114951003154468623837163747301415788506257394432111971249939930190623004010828644954345144382022285648776685520198124647964878882233913454926887367287033636361936535824031934945200885639287766338519911212648545122052722064
c = 5884615664079149791505635618526424461431630318297039596540366545703925520459923270885231808693071837903203732439615490892995303781165132717440126940731900095919916968333903944416594993901007405527190160282994522126669139201893889700934617754629274280592248878132895637259785453513413763381122398602062310006984823004954109151914576922184685617564781860589867202492729060160952896865633413966121138288239540682101883407904180269234687206790419673692286207029824477454317655202167556263908118595997806490467595605323835098119528014284721427857904537483795134273587285100779675107231104080762187051480482061998107751205
e = 65537

for i in range(10):
    phi=gift*i
    try:
        d=gmpy2.invert(e,phi)
        p = getpq(n,e,d)
        q = n // p
        assert (p-1)*(q-1) == phi #确定正确的p,q
        m=gmpy2.powmod(c,d,n)
        print(n2s(int(m)))
    except:
        pass